5 PROCassemble10 MODE 215 VDU 23,1,0;0;0;0;20 VDU 28,0,30,19,2625 PROCtake_data30 VDU 28,0,23,19,035 CLS40 level%=045 column%=050 r%=155 REPEAT60 IF r% PROCplotmap(level%, column%)65 r%=070 key%=GET75 IF key%=44 AND column%>0 THEN column%=column%-5:r%=180 IF key%=46 THEN column%=column%+5:r%=185 IF column%>76 THEN column%=7690 UNTIL FALSE95 END100105 DEF PROCassemble110 FOR T%=0 TO 2 STEP 2115 P%=&1700120 plot%=P%125 [OPT T%130 LDY #31135 .loop140 LDA (&70),Y145 STA (&72),Y150 DEY155 BPL loop160 RTS165 ]170 splittiles%=P%175 [OPT T%     ; 70=tile pair -> 70=left tile, 71=right tile180 LDA &70185 AND #&F0190 LSR A : CLC195 LSR A : CLC200 LSR A : CLC205 LSR A : CLC210 STA &71215 LDA &70220 AND #&0F    ; left column225 STA &70230 RTS235 ]240 NEXT245 ENDPROC250255 DEF PROCtake_data260 ADDR% = &3000265 OSCLI("LOAD CODE "+STR$~(ADDR%))270 FOR A%=0 TO 31275 !&70=&4D00+(A%*32)280 !&72=&2200+(A%*32)285 CALL plot%290 !&70=&5100+(A%*32)295 !&72=&2600+(A%*32)300 CALL plot%305 !&70=&3000+(A%*32)310 !&72=&2A00+(A%*32)315 CALL plot%320 NEXT325 CLS330 FOR A%=0 TO &810 STEP 32335 !&70=&5BE0+A%340 !&72=&7600+A%345 CALL plot%350 NEXT355 FOR A%=&800 TO &810 STEP 2360 !(&7600+A%)=!(&5BE0+A%)365 NEXT370 ENDPROC375380 DEF PROCplot(l%, n%, x%, y%)385 !&70=&2200+(l%*&400)+(n%*64)390 !&72=&3000+(y%*&280)+(x%*32)395 CALL plot%400 !&70=&2200+(l%*&400)+(n%*64)+32405 !&72=&3000+((y%+1)*&280)+(x%*32)410 CALL plot%415 ENDPROC420 DEF PROCplotmap(l%, c%)425 FOR X%=0 TO 9430 FOR Y%=0 TO 11435 ?&70=?(&7600 + (l% * &408) + (c% + X%)*12 + Y%)440 CALL splittiles%445 left%=?&70450 right%=?&71455 !&70=&2200 + (l% * &400) + (left% * &40)460 !&72=&3000 + (Y% * 2 * &280) + ((X% * 2) * &20)465 CALL plot%470 !&70=&2200 + (l% * &400) + (left% * &40) + &20475 !&72=&3000 + (((Y% * 2) + 1) * &280) + ((X% * 2) * &20)480 CALL plot%485 !&70=&2200 + (l% * &400) + (right% * &40)490 !&72=&3000 + (Y% * 2 * &280) + (((X% * 2) + 1) * &20)495 CALL plot%500 !&70=&2200 + (l% * &400) + (right% * &40) + &20505 !&72=&3000 + (((Y% * 2) + 1) * &280) + (((X% * 2) + 1) * &20)510 CALL plot%515 NEXT520 NEXT525 ENDPROC