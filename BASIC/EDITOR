AUTOMODE 2HIMEM=&2300VDU 23,1,0;0;0;0;VDU 28,0,30,19,26*FX 4,1PROCinitPROCtake_dataVDU 28,0,23,19,0CLSlevel%=0PROCinitlevelcolumn%=0x%=0y%=0r%=1REPEATIF r% PROCplotmap(level%, column%):PROCeorplotr%=0key%=GETIF key%=44 AND column%>0 THEN column%=column%-5:r%=1IF key%=46 THEN column%=column%+5:r%=1IF key%=33 THEN level%=0:PROCinitlevel:r%=1IF key%=34 THEN level%=1:PROCinitlevel:r%=1IF key%=35 THEN level%=2:PROCinitlevel:r%=1IF key%=90 AND x%>0 THEN PROCeorplot:x%=x%-1:PROCeorplotIF key%=88 AND x%<19 THEN PROCeorplot:x%=x%+1:PROCeorplotIF key%=58 AND y%>0 THEN PROCeorplot:y%=y%-1:PROCeorplotIF key%=47 AND y%<11 THEN PROCeorplot:y%=y%+1:PROCeorplotIF key%>47 AND key%<58 THEN PROCeorplot:PROCsettile(key%-48):PROCeorplotIF key%>64 AND key%<71 THEN PROCeorplot:PROCsettile(key%-55):PROCeorplotIF key%=76 THEN PROCload:r%=1IF key%=83 THEN PROCsave:r%=1IF key%=82 THEN PROCpatchIF column%>76 THEN column%=76UNTIL FALSEENDDEF PROCinitCODE% = &1900OSCLI("LOAD EDCODE "+STR$~(CODE%))plot%=CODE%plot64%=CODE% + &0Ainittiles%=CODE% + &29plotmap%=CODE% + &87eorplot64%=CODE% + &112ENDPROCDEF PROCinitlevelVDU19,12,1,0,0,0VDU19,13,1,0,0,0IF level%=0 THEN VDU19,1,5,0,0,0:VDU19,2,2,0,0,0:VDU19,3,3,0,0,0:VDU19,4,2,0,0,0:VDU19,6,3,0,0,0IF level%=1 THEN VDU19,1,5,0,0,0:VDU19,2,4,0,0,0:VDU19,3,6,0,0,0:VDU19,4,2,0,0,0IF level%=2 THEN VDU19,1,5,0,0,0:VDU19,2,3,0,0,0:VDU19,3,7,0,0,0:VDU19,4,2,0,0,0ENDPROCDEF PROCtake_dataADDR% = &3000OSCLI("LOAD CODE0 "+STR$~(ADDR%))CLSFOR A%=0 TO 31!&70=&4D00+(A%*32)!&72=&6C00+(A%*32)CALL plot%!&70=&5100+(A%*32)!&72=&7000+(A%*32)CALL plot%!&70=&3000+(A%*32)!&72=&7400+(A%*32)CALL plot%NEXTFOR A%=0 TO &C00 STEP 32!&70=&5BE0+A%!&72=&23E8+A%CALL plot%NEXTFOR A%=&C00 TO &C18 STEP 2!(&23E8+A%)=!(&5BE0+A%)NEXTCALL inittiles%ENDPROCDEF PROCplotmap(l%, c%)!&74 = &6C00 + (l% * &400)!&76 = &23E8 + (l% * &408) + (c% * 12)CALL plotmap%ENDPROCDEF PROCeorplot!&70=&3000+(y%*&500)+(x%*32)CALL eorplot64%ENDPROCDEF PROCsettile(t%)addr%=&23E8 + (l% * &408) + ((column% + (x% DIV 2)) * 12) + y%old%=?addr%IF x% MOD 2 = 0 THEN ?addr%=(old% AND 240) OR t% ELSE ?addr%=(old% AND 15) OR t%*16!&70=&6C00+(level%*&400)+(t%*64)!&72=&3000+(y%*&500)+(x%*32)CALL plot64%ENDPROCDEF PROCloadINPUT "Load maps:", f$OSCLI("LOAD "+f$+" 23E8")ENDPROCDEF PROCsaveINPUT "Save as:", f$OSCLI("SAVE "+f$+" 23E8 3000")ENDPROCDEF PROCpatchINPUT "Use maps:", f$OSCLI("LOAD CODE0")OSCLI("LOAD "+f$+" 4BE0")OSCLI("SAVE CODE 2000 5C00 2000")CHAIN "LOADER"ENDPROC